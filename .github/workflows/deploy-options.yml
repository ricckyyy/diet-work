name: ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒé¸æŠž

on:
  workflow_dispatch:
    inputs:
      deploy_target:
        description: 'ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã‚’é¸æŠžã—ã¦ãã ã•ã„'
        required: true
        type: choice
        options:
          - 'vercel'
          - 'netlify'
          - 'cloudflare-pages'
          - 'railway'
          - 'render'

permissions:
  contents: write
  pull-requests: write
  issues: write

jobs:
  create-deployment-pr:
    runs-on: ubuntu-latest
    name: ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šPRã‚’ä½œæˆ
    
    steps:
      - name: ãƒªãƒã‚¸ãƒˆãƒªã®ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: Gitãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
      
      - name: ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ
        run: |
          BRANCH_NAME="deploy/${{ github.event.inputs.deploy_target }}-$(date +%s)"
          git checkout -b $BRANCH_NAME
          echo "BRANCH_NAME=$BRANCH_NAME" >> $GITHUB_ENV
      
      - name: Vercelè¨­å®šã‚’è¿½åŠ 
        if: github.event.inputs.deploy_target == 'vercel'
        run: |
          cat > vercel.json << 'EOF'
          {
            "buildCommand": "npm run build",
            "devCommand": "npm run dev",
            "installCommand": "npm install",
            "framework": "nextjs",
            "outputDirectory": ".next"
          }
          EOF
          
          cat > .vercelignore << 'EOF'
          node_modules
          .next
          .env*
          prisma/dev.db
          EOF
          
          git add vercel.json .vercelignore
      
      - name: Netlifyè¨­å®šã‚’è¿½åŠ 
        if: github.event.inputs.deploy_target == 'netlify'
        run: |
          cat > netlify.toml << 'EOF'
          [build]
            command = "npm run build"
          
          [build.environment]
            NODE_VERSION = "20"
          
          [[plugins]]
            package = "@netlify/plugin-nextjs"
          EOF
          
          git add netlify.toml
      
      - name: Cloudflare Pagesè¨­å®šã‚’è¿½åŠ 
        if: github.event.inputs.deploy_target == 'cloudflare-pages'
        run: |
          APP_NAME="${GITHUB_REPOSITORY#*/}"
          COMPAT_DATE=$(date +%Y-%m-%d)
          cat > wrangler.toml << EOF
          name = "$APP_NAME"
          compatibility_date = "$COMPAT_DATE"
          
          [build]
            command = "npm run build"
          EOF
          
          # Next.jsã®Cloudflare Pageså¯¾å¿œã«ã¤ã„ã¦ã®ãƒ¡ãƒ¢ã‚’è¿½åŠ 
          cat > CLOUDFLARE_DEPLOY_NOTE.md << 'EOF'
          # Cloudflare Pagesãƒ‡ãƒ—ãƒ­ã‚¤ã«é–¢ã™ã‚‹æ³¨æ„äº‹é …
          
          Cloudflare Pagesã¯ã€Next.jsã®ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯æ©Ÿèƒ½ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ãŒã€
          è¨­å®šã«ã¯ä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼š
          
          1. ãƒ“ãƒ«ãƒ‰ã‚³ãƒžãƒ³ãƒ‰: `npm run build`
          2. å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: è‡ªå‹•æ¤œå‡ºã•ã‚Œã¾ã™ï¼ˆ`.next`ï¼‰
          3. Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³: 20ã‚’é¸æŠž
          
          ## ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
          Cloudflareãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ä»¥ä¸‹ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼š
          - `DATABASE_URL`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æŽ¥ç¶šæ–‡å­—åˆ—
          
          ## å‚è€ƒæƒ…å ±
          - https://developers.cloudflare.com/pages/framework-guides/nextjs/
          EOF
          
          git add wrangler.toml CLOUDFLARE_DEPLOY_NOTE.md
      
      - name: Railwayè¨­å®šã‚’è¿½åŠ 
        if: github.event.inputs.deploy_target == 'railway'
        run: |
          cat > railway.json << 'EOF'
          {
            "$schema": "https://railway.app/railway.schema.json",
            "build": {
              "builder": "NIXPACKS",
              "buildCommand": "npm run build"
            },
            "deploy": {
              "startCommand": "npm run start",
              "restartPolicyType": "ON_FAILURE",
              "restartPolicyMaxRetries": 10
            }
          }
          EOF
          
          cat > nixpacks.toml << 'EOF'
          [phases.setup]
            nixPkgs = ["nodejs-20_x", "npm-10_x"]
          
          [phases.install]
            cmds = ["npm ci"]
          
          [phases.build]
            cmds = ["npm run build", "npx prisma generate"]
          
          [start]
            cmd = "npm run start"
          EOF
          
          git add railway.json nixpacks.toml
      
      - name: Renderè¨­å®šã‚’è¿½åŠ 
        if: github.event.inputs.deploy_target == 'render'
        run: |
          APP_NAME="${GITHUB_REPOSITORY#*/}"
          
          # Prismaã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ç¢ºèª
          if [ -f "prisma/schema.prisma" ]; then
            BUILD_CMD="npm install && npm run build && npx prisma generate"
          else
            BUILD_CMD="npm install && npm run build"
          fi
          
          cat > render.yaml << EOF
          services:
            - type: web
              name: $APP_NAME
              env: node
              plan: free
              buildCommand: $BUILD_CMD
              startCommand: npm run start
              envVars:
                - key: NODE_VERSION
                  value: 20
                - key: DATABASE_URL
                  sync: false
          EOF
          
          git add render.yaml
      
      - name: READMEæ›´æ–°
        run: |
          TARGET="${{ github.event.inputs.deploy_target }}"
          
          # READMEã«è¿½åŠ ã™ã‚‹ãƒ‡ãƒ—ãƒ­ã‚¤ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
          cat > deploy_section.md << 'DEPLOY_EOF'
          
          ---
          
          DEPLOY_EOF
          
          case $TARGET in
            vercel)
              cat >> deploy_section.md << 'VERCEL_EOF'
          ## Vercelã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
          
          ### æº–å‚™
          1. [Vercel](https://vercel.com)ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          2. GitHubãƒªãƒã‚¸ãƒˆãƒªã¨é€£æº
          
          ### ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
          1. Vercelãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒNew Projectã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          2. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠž
          3. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š:
             - `DATABASE_URL`: PostgreSQLæŽ¥ç¶šæ–‡å­—åˆ—ï¼ˆVercel Postgresã‚’ä½¿ç”¨å¯èƒ½ï¼‰
          4. ã€ŒDeployã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          
          ### è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
          - mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™
          - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã‚‚ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«è‡ªå‹•ä½œæˆã•ã‚Œã¾ã™
          VERCEL_EOF
              ;;
            netlify)
              cat >> deploy_section.md << 'NETLIFY_EOF'
          ## Netlifyã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
          
          ### æº–å‚™
          1. [Netlify](https://netlify.com)ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          2. GitHubãƒªãƒã‚¸ãƒˆãƒªã¨é€£æº
          
          ### ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
          1. Netlifyãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒAdd new siteã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          2. ã€ŒImport an existing projectã€ã‚’é¸æŠž
          3. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠž
          4. ãƒ“ãƒ«ãƒ‰è¨­å®š:
             - Build command: `npm run build`
             - Publish directory: `.next`
          5. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š:
             - `DATABASE_URL`: PostgreSQLæŽ¥ç¶šæ–‡å­—åˆ—
          6. ã€ŒDeploy siteã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          
          ### è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
          - mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™
          NETLIFY_EOF
              ;;
            cloudflare-pages)
              cat >> deploy_section.md << 'CLOUDFLARE_EOF'
          ## Cloudflare Pagesã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
          
          ### æº–å‚™
          1. [Cloudflare](https://cloudflare.com)ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          2. Pagesæ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–
          
          ### ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
          1. Cloudflareãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒPagesã€ã‚’é¸æŠž
          2. ã€ŒCreate a projectã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          3. ã“ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’æŽ¥ç¶š
          4. ãƒ“ãƒ«ãƒ‰è¨­å®š:
             - Build command: `npm run build`
             - Build output directory: `.next`
          5. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š:
             - `DATABASE_URL`: D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¾ãŸã¯å¤–éƒ¨PostgreSQL
          6. ã€ŒSave and Deployã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          
          ### è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
          - mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™
          CLOUDFLARE_EOF
              ;;
            railway)
              cat >> deploy_section.md << 'RAILWAY_EOF'
          ## Railwayã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
          
          ### æº–å‚™
          1. [Railway](https://railway.app)ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          2. GitHubãƒªãƒã‚¸ãƒˆãƒªã¨é€£æº
          
          ### ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
          1. Railwayãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒNew Projectã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          2. ã€ŒDeploy from GitHub repoã€ã‚’é¸æŠž
          3. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠž
          4. PostgreSQLã‚µãƒ¼ãƒ“ã‚¹ã‚’è¿½åŠ :
             - ã€ŒNewã€â†’ã€ŒDatabaseã€â†’ã€ŒPostgreSQLã€
          5. ç’°å¢ƒå¤‰æ•°ã‚’è‡ªå‹•è¨­å®šï¼ˆDATABASE_URLãŒè‡ªå‹•ã§è¨­å®šã•ã‚Œã¾ã™ï¼‰
          6. ãƒ‡ãƒ—ãƒ­ã‚¤ãŒè‡ªå‹•é–‹å§‹ã•ã‚Œã¾ã™
          
          ### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
          åˆå›žãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€Railwayã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§:
          ```bash
          npx prisma migrate deploy
          ```
          
          ### è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
          - mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™
          RAILWAY_EOF
              ;;
            render)
              cat >> deploy_section.md << 'RENDER_EOF'
          ## Renderã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
          
          ### æº–å‚™
          1. [Render](https://render.com)ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          2. GitHubãƒªãƒã‚¸ãƒˆãƒªã¨é€£æº
          
          ### ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
          1. Renderãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒNewã€â†’ã€ŒWeb Serviceã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          2. ã“ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠž
          3. è¨­å®šã‚’ç¢ºèª:
             - Build Command: `npm install && npm run build && npx prisma generate`
             - Start Command: `npm run start`
          4. PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆ:
             - ã€ŒNewã€â†’ã€ŒPostgreSQLã€
          5. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š:
             - `DATABASE_URL`: ä½œæˆã—ãŸPostgreSQLã®å†…éƒ¨URL
          6. ã€ŒCreate Web Serviceã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          
          ### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
          åˆå›žãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€Renderã®ã‚·ã‚§ãƒ«ã§:
          ```bash
          npx prisma migrate deploy
          ```
          
          ### è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
          - mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™
          RENDER_EOF
              ;;
          esac
          
          # README.mdã®æœ€å¾Œã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
          if ! grep -q "ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤" README.md; then
            cat deploy_section.md >> README.md
          fi
          
          git add README.md
      
      - name: å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ
        run: |
          git commit -m "feat: ${{ github.event.inputs.deploy_target }}ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šã‚’è¿½åŠ "
      
      - name: ãƒ–ãƒ©ãƒ³ãƒã‚’ãƒ—ãƒƒã‚·ãƒ¥
        run: |
          git push origin ${{ env.BRANCH_NAME }}
      
      - name: ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          TARGET="${{ github.event.inputs.deploy_target }}"
          
          # PRã®èª¬æ˜Žæ–‡ã‚’ä½œæˆ
          case $TARGET in
            vercel)
              cat > pr_description.md << 'PR_EOF'
          ## ðŸš€ Vercelãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š
          
          ã“ã®è¨­å®šã«ã‚ˆã‚Šã€Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™ã€‚
          
          ### ç‰¹å¾´
          - âœ… Next.jsã®å…¬å¼æŽ¨å¥¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
          - âœ… æœ€ã‚‚ç°¡å˜ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
          - âœ… è‡ªå‹•ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒ
          - âœ… Vercel Postgresçµ±åˆ
          
          ### ç„¡æ–™ãƒ—ãƒ©ãƒ³ã®åˆ¶é™
          - æœˆ100GBã®å¸¯åŸŸå¹…
          - 6,000ãƒ“ãƒ«ãƒ‰åˆ†/æœˆ
          - Serverless Functions: 100GB-Hours
          
          ### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
          1. ã“ã®PRã‚’ãƒžãƒ¼ã‚¸
          2. Vercelã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          3. GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’æŽ¥ç¶š
          4. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤
          PR_EOF
              ;;
            netlify)
              cat > pr_description.md << 'PR_EOF'
          ## ðŸš€ Netlifyãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š
          
          ã“ã®è¨­å®šã«ã‚ˆã‚Šã€Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Netlifyã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™ã€‚
          
          ### ç‰¹å¾´
          - âœ… ç°¡å˜ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
          - âœ… ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ—ãƒ­ã‚¤
          - âœ… ãƒ•ã‚©ãƒ¼ãƒ å‡¦ç†æ©Ÿèƒ½
          - âœ… Netlify Identityèªè¨¼
          
          ### ç„¡æ–™ãƒ—ãƒ©ãƒ³ã®åˆ¶é™
          - æœˆ100GBã®å¸¯åŸŸå¹…
          - 300ãƒ“ãƒ«ãƒ‰åˆ†/æœˆ
          - ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹é–¢æ•°: 125Kå®Ÿè¡Œ/æœˆ
          
          ### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
          1. ã“ã®PRã‚’ãƒžãƒ¼ã‚¸
          2. Netlifyã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          3. GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’æŽ¥ç¶š
          4. `@netlify/plugin-nextjs`ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’æœ‰åŠ¹åŒ–
          PR_EOF
              ;;
            cloudflare-pages)
              cat > pr_description.md << 'PR_EOF'
          ## ðŸš€ Cloudflare Pagesãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š
          
          ã“ã®è¨­å®šã«ã‚ˆã‚Šã€Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Cloudflare Pagesã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™ã€‚
          
          ### ç‰¹å¾´
          - âœ… é«˜é€ŸCDNé…ä¿¡
          - âœ… ç„¡åˆ¶é™ã®å¸¯åŸŸå¹…ï¼ˆç„¡æ–™ï¼‰
          - âœ… D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆ
          - âœ… Workersçµ±åˆ
          
          ### ç„¡æ–™ãƒ—ãƒ©ãƒ³ã®åˆ¶é™
          - 500ãƒ“ãƒ«ãƒ‰/æœˆ
          - ç„¡åˆ¶é™ã®å¸¯åŸŸå¹…ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
          - D1: 100Kãƒªãƒ¼ãƒ‰/æ—¥ã€50Kãƒ©ã‚¤ãƒˆ/æ—¥
          
          ### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
          1. ã“ã®PRã‚’ãƒžãƒ¼ã‚¸
          2. Cloudflareã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          3. GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’æŽ¥ç¶š
          4. D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆã¾ãŸã¯PostgreSQLï¼‰
          PR_EOF
              ;;
            railway)
              cat > pr_description.md << 'PR_EOF'
          ## ðŸš€ Railwayãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š
          
          ã“ã®è¨­å®šã«ã‚ˆã‚Šã€Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Railwayã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™ã€‚
          
          ### ç‰¹å¾´
          - âœ… PostgreSQLçµ±åˆãŒç°¡å˜
          - âœ… ç’°å¢ƒå¤‰æ•°ã®è‡ªå‹•è¨­å®š
          - âœ… Gitçµ±åˆãƒ‡ãƒ—ãƒ­ã‚¤
          - âœ… ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒå®¹æ˜“
          
          ### ç„¡æ–™ãƒ—ãƒ©ãƒ³ã®åˆ¶é™
          - $5ç›¸å½“ã®ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ/æœˆ
          - ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ã«å¿œã˜ã¦æ¶ˆè²»
          - å°è¦æ¨¡ã‚¢ãƒ—ãƒªãªã‚‰ååˆ†
          
          ### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
          1. ã“ã®PRã‚’ãƒžãƒ¼ã‚¸
          2. Railwayã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          3. GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’æŽ¥ç¶š
          4. PostgreSQLã‚µãƒ¼ãƒ“ã‚¹ã‚’è¿½åŠ 
          5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
          PR_EOF
              ;;
            render)
              cat > pr_description.md << 'PR_EOF'
          ## ðŸš€ Renderãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š
          
          ã“ã®è¨­å®šã«ã‚ˆã‚Šã€Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Renderã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™ã€‚
          
          ### ç‰¹å¾´
          - âœ… PostgreSQLçµ±åˆ
          - âœ… è‡ªå‹•SSLè¨¼æ˜Žæ›¸
          - âœ… ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒ
          - âœ… ã‚·ãƒ³ãƒ—ãƒ«ãªè¨­å®š
          
          ### ç„¡æ–™ãƒ—ãƒ©ãƒ³ã®åˆ¶é™
          - 750æ™‚é–“/æœˆã®ç„¡æ–™ç¨¼åƒæ™‚é–“
          - éžã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚ã¯è‡ªå‹•ã‚¹ãƒªãƒ¼ãƒ—
          - PostgreSQL: 90æ—¥é–“ç„¡æ–™ï¼ˆãã®å¾Œæœ‰æ–™ï¼‰
          
          ### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
          1. ã“ã®PRã‚’ãƒžãƒ¼ã‚¸
          2. Renderã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
          3. GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’æŽ¥ç¶š
          4. PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆ
          5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
          PR_EOF
              ;;
          esac
          
          # PRã‚’ä½œæˆ
          gh pr create \
            --title "feat: ${{ github.event.inputs.deploy_target }}ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š" \
            --body-file pr_description.md \
            --base main \
            --head ${{ env.BRANCH_NAME }}

  deploy-info:
    runs-on: ubuntu-latest
    name: ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒæƒ…å ±ã‚’è¡¨ç¤º
    
    steps:
      - name: é¸æŠžã•ã‚ŒãŸãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã‚’è¡¨ç¤º
        run: |
          echo "## âœ… ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šã®æº–å‚™å®Œäº†"
          echo ""
          echo "é¸æŠžã•ã‚ŒãŸãƒ‡ãƒ—ãƒ­ã‚¤å…ˆ: **${{ github.event.inputs.deploy_target }}**"
          echo ""
          echo "ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚"
          echo "PRã‚’ç¢ºèªã—ã¦ã€å•é¡Œãªã‘ã‚Œã°ãƒžãƒ¼ã‚¸ã—ã¦ãã ã•ã„ã€‚"
