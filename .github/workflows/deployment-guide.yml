name: ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒé¸æŠžã®æ¡ˆå†…

on:
  release:
    types: [published]

permissions:
  issues: write
  contents: read

jobs:
  create-deployment-issue:
    runs-on: ubuntu-latest
    name: ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒé¸æŠžã®Issueã‚’ä½œæˆ
    
    steps:
      - name: ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒé¸æŠžã®Issueã‚’ä½œæˆ
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          cat > issue_body.md << 'EOF'
          # ðŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒã®é¸æŠž

          ãƒªãƒªãƒ¼ã‚¹ **${{ github.event.release.tag_name }}** ãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼

          æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ç„¡æ–™ç’°å¢ƒã‚’é¸æŠžã—ã¦ãã ã•ã„ã€‚

          ## ðŸ“‹ ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒã®å€™è£œ

          ä»¥ä¸‹ã®ç„¡æ–™ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒã‹ã‚‰é¸æŠžã§ãã¾ã™ï¼š

          ### 1. âœ… Vercelï¼ˆæŽ¨å¥¨ï¼‰
          - **ç‰¹å¾´**: Next.jsã®å…¬å¼æŽ¨å¥¨ã€æœ€ã‚‚ç°¡å˜ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
          - **ç„¡æ–™æž **: æœˆ100GBå¸¯åŸŸå¹…ã€6,000ãƒ“ãƒ«ãƒ‰åˆ†/æœˆ
          - **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Vercel Postgresï¼ˆPostgreSQLï¼‰
          - **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ç°¡å˜ã•**: â­â­â­â­â­
          - **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://vercel.com/docs

          ### 2. Netlify
          - **ç‰¹å¾´**: å¤šæ©Ÿèƒ½ã€ãƒ•ã‚©ãƒ¼ãƒ å‡¦ç†ã‚„èªè¨¼æ©Ÿèƒ½ã‚ã‚Š
          - **ç„¡æ–™æž **: æœˆ100GBå¸¯åŸŸå¹…ã€300ãƒ“ãƒ«ãƒ‰åˆ†/æœˆ
          - **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: å¤–éƒ¨PostgreSQLå¿…è¦
          - **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ç°¡å˜ã•**: â­â­â­â­
          - **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://docs.netlify.com

          ### 3. Cloudflare Pages
          - **ç‰¹å¾´**: é«˜é€ŸCDNã€ç„¡åˆ¶é™ã®å¸¯åŸŸå¹…
          - **ç„¡æ–™æž **: ç„¡åˆ¶é™ã®å¸¯åŸŸå¹…ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€500ãƒ“ãƒ«ãƒ‰/æœˆ
          - **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: D1ï¼ˆSQLiteï¼‰ã¾ãŸã¯PostgreSQL
          - **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ç°¡å˜ã•**: â­â­â­â­
          - **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://developers.cloudflare.com/pages

          ### 4. Railway
          - **ç‰¹å¾´**: PostgreSQLçµ±åˆãŒç°¡å˜ã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒå®¹æ˜“
          - **ç„¡æ–™æž **: $5ç›¸å½“ã®ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ/æœˆ
          - **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQLçµ±åˆ
          - **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ç°¡å˜ã•**: â­â­â­â­
          - **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://docs.railway.app

          ### 5. Render
          - **ç‰¹å¾´**: PostgreSQLçµ±åˆã€è‡ªå‹•SSLè¨¼æ˜Žæ›¸
          - **ç„¡æ–™æž **: 750æ™‚é–“/æœˆï¼ˆéžã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚ã‚¹ãƒªãƒ¼ãƒ—ï¼‰
          - **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQLï¼ˆ90æ—¥é–“ç„¡æ–™ã€ãã®å¾Œæœ‰æ–™ï¼‰
          - **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ç°¡å˜ã•**: â­â­â­â­
          - **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://render.com/docs

          ## ðŸŽ¯ æŽ¨å¥¨ç’°å¢ƒ

          ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ **Vercel** ã‚’æŽ¨å¥¨ã—ã¾ã™ï¼š
          - Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«æœ€é©åŒ–
          - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒæœ€ã‚‚ç°¡å˜
          - Vercel Postgresã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚‚ç°¡å˜ã«çµ±åˆ
          - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹

          ## ðŸ“ ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•

          é¸æŠžã—ãŸç’°å¢ƒã®ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šã‚’è¿½åŠ ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼š

          1. [Actions]ã‚¿ãƒ–ã‚’é–‹ã
          2. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒé¸æŠžã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’é¸æŠž
          3. ã€ŒRun workflowã€ã‚’ã‚¯ãƒªãƒƒã‚¯
          4. ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‹ã‚‰å¸Œæœ›ã®ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã‚’é¸æŠž
          5. ã€ŒRun workflowã€ã‚’å®Ÿè¡Œ

          ã™ã‚‹ã¨ã€é¸æŠžã—ãŸç’°å¢ƒã®ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚€ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè‡ªå‹•ä½œæˆã•ã‚Œã¾ã™ã€‚

          ## ðŸ”„ ãƒ‡ãƒ—ãƒ­ã‚¤ã®æµã‚Œ

          1. ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šPRã‚’ç¢ºèªã—ã¦ãƒžãƒ¼ã‚¸
          2. é¸æŠžã—ãŸãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
          3. GitHubãƒªãƒã‚¸ãƒˆãƒªã‚’æŽ¥ç¶š
          4. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
          5. ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ï¼

          ä»¥é™ã€mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•çš„ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ã€‚

          ---

          **è³ªå•ã‚„å•é¡ŒãŒã‚ã‚‹å ´åˆã¯ã€ã“ã®Issueã«ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ãã ã•ã„ã€‚**
          EOF

          gh issue create \
            --title "ðŸš€ ãƒªãƒªãƒ¼ã‚¹ ${{ github.event.release.tag_name }}: ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒã‚’é¸æŠžã—ã¦ãã ã•ã„" \
            --body-file issue_body.md \
            --label "deployment" \
            --repo ${{ github.repository }}
